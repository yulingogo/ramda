#### 1. 解释一下什么是函数式编程

命令式编程的缺点：命令式编程也能完成任务，但最终的结果是会产生一堆中间临时变量，同时过程中掺杂了大量的逻辑，通常一个函数需要从头读到尾才能知道它具体做了什么，而且一旦出了问题很难定位。

函数式编程的思维过程是完全不同的，它的着眼点是函数，而不是过程，它强调的是如何通过函数的组合变换去解决问题，而不是我通过写什么样的语句去解决问题，当代码越来越多的时候，这种函数的拆分和组合就会产生强大的力量。

函数实际上是一种关系，或者说是一种映射，而这种映射是可以组合的，一个函数的输出可以作为另一个函数的输入。这便是组合，也即数学上的复合运算。

我们编程需要处理的其实也是'数据'和'关系'。关系便是函数。编程工作不过是在寻找一种映射关系。

我们可以用流水线来形容这种工作，把输入当作原料，把输出当作产品，数据可以不断地从一个函数的输出流入另一个函数的输入，最后再输出结果，这不就是一套流水线。

函数式编程的重点便是如何去构建关系。



#### 2. 函数式编程的特点

##### 2.1 函数是一等公民

这是函数式编程得以实现的前提。因为我们的基本操作都是在操作函数。这个特性意味着函数和其他的数据类型一样，处于平等地位。可以复制给其他变量，也可以作为参数，纯如另一个函数，或者作为其他函数的返回值。

##### 2.2 声明式编程

函数式编程大多时候都是在声明我需要做什么，而不是怎么去做，这种编程风格称为声明式编程。这样的代码可读性高，因为它不关心具体的实现，它可以把优化能力交给具体的实现，这也方便进行分工协作。

SQL 语句就是声明式的，你无需关心 Select 语句是如何实现的，不同的数据库会去实现它自己的方法并且优化。React 也是声明式的，你只要描述你的 UI，接下来状态变化后 UI 如何更新，是 React 在运行时帮你处理的，而不是靠你自己去渲染和优化 diff 算法。

##### 2.3 惰性执行

指的是函数只有在需要的时候执行，即不产生无意义的中间变量。

##### 2.4 无状态和数据不可变

这是函数式编程的核心概念：

数据不可变：他要求你的数据都是不可变的，这意味着如果你想修改一个对象，那你应该创建一个新的对象，而不是修改一个已有对象。

无状态：强调对于一个函数，不管你何时运行，你都应该像第一次运行一样，给定相同的输入，就会给出相同的输出，完全不依赖外部状态的变化。

为了实现这个目标，函数式编程提出函数应该具备的特性：没有副作用和纯函数。

##### 2.5 没有副作用

副作用的含义：在完成函数的主要功能之外完成的其他副要功能。在函数中的主要功能是根据输入返回结果。最常见的副作用就是随意操纵外部变量。由于js中对象传递的是引用地址，即使我们用const申明的对象，他依旧是可变的，这个漏洞导致我们有机会改变对象。

保证函数没有副作用，一来可以保证数据的不可变性，二来能避免因为共享状态带来的问题。一个人维护代码可能还不够明显，但随着项目的迭代，项目参与人数的增加，大家对同一变量的依赖和引用越来越多，这种问题会越来越严重。

##### 2.6 纯函数

纯函数是在没有副作用的要求上更进一步。

纯函数的概念就两点：

+ 不依赖外部状态（无状态）：函数的运行结果不依赖全局变量，this指针，io操作等
+ 没有副作用（数据不变）：不修改全局变量，不修改入参

所以纯函数才是真正意义上的函数，它意味着相同的输入，永远得到相同的输出。

纯函数的意义:

+ 便于测试有优化。由于纯函数相同的输入会返回相同的结果，因此我们可以断言函数的执行结果。同时也可以保证函数的优化不会影响其他代码的执行。符合测试驱动开发。代码具有健壮性。
+ 可缓存性。相同的输入意味着相同的输出，因此可以缓存函数的执行结果。很多库都有memoize函数。React.memo，如果你的函数组件在给定相同 props 的情况下渲染相同的结果。
+ 自文档化。由于纯函数没有副作用，所以其依赖很明确，因此更便于观察和理解。
+ 更少的bug。使用纯函数意味着不使用全局变量，不存在对参数的更改，不存在指向不明的this，这些共享状态往往是大多数bug的源头。

#### 3.加工站--柯里化

##### 3.1 为什么需要柯里化

函数式编程处理的是关系。我们寻求一种流水线的方式来解决问题。函数输出可以作为另一个函数的输入，函数的返回值有且只有一个。那么作为这条流水线上的函数的输入也只能只有一个。柯里化的结果正好就是单输入的。

##### 3.2 高级柯里化

很多库的curry函数都做了优化。可以理解为高级柯里化。这些版本的函数可以根据你输入的参数个数，返回一个柯里化的函数或者结果。也即，如果你给的参数个数满足了函数条件，即返回值。这样可以解决一个问题，即一个函数如果是多输入，柯里化之后可以避免使用(a)(b)(c)这种形式传参。

#### 4. 流水线--函数组合

借助curry，已经可以很轻松的构造加工站了，现在就是我们组合成流水线的时候了。

##### 4.1 函数组合的概念

将多个函数组合成一个函数。

```javascript
const upperLastItem = compose(log, toUpperCase, head, reverse);
```

compose将函数组合起来，形成了一套流水线，所有经过这条流水线的参数都会经历reverse,head...这些函数的加工，最后生成结果。

最完美的是这些函数都是非常简单的纯函数，可以随意组合。

我们发现，这就像所谓的管道（pipe）的概念，只是执行方向刚好相反。

##### 4.2 函数组合的好处

函数组合的好处显而易见，它让代码变得简单而富有可读性。通过不同的组合方式，可以轻易的组合出其他函数。

由此可见，大型的程序，都可以通过这样一步步的拆分组合实现，剩下要做的，就是去构造足够的积木（函数）。

